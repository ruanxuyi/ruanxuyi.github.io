<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  
    
      
    

    
  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Bree Serif:300,300italic,400,400italic,700,700italic|Arimo:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Cache,DataStructure,HashMap,LRU,LinkedList,LintCode," />








  <link rel="shortcut icon" type="image/x-icon" href="/images/sushi.png?v=5.0.1" />






<meta name="description" content="description 
 code LinkedList + HashMap enhanced Ver.public class Solution &amp;#123;    class ListNode &amp;#123;        int val;        int key;        ListNode next;        ListNode prev;                pu">
<meta property="og:type" content="article">
<meta property="og:title" content="lru cache">
<meta property="og:url" content="http://www.xuyiruan.com/2017/01/09/lru-cache/index.html">
<meta property="og:site_name" content="阮先生de小窝">
<meta property="og:description" content="description 
 code LinkedList + HashMap enhanced Ver.public class Solution &amp;#123;    class ListNode &amp;#123;        int val;        int key;        ListNode next;        ListNode prev;                pu">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="lru cache">
<meta name="twitter:description" content="description 
 code LinkedList + HashMap enhanced Ver.public class Solution &amp;#123;    class ListNode &amp;#123;        int val;        int key;        ListNode next;        ListNode prev;                pu">




<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>

  <title> lru cache | 阮先生de小窝 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">阮先生de小窝</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">多读书 多思考 少吃零食 多睡觉</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                lru cache
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2017-01-09T09:41:31-05:00" content="01-09-2017">
              01-09-2017
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/01/09/lru-cache/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/01/09/lru-cache/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2017/01/09/lru-cache/" class="leancloud_visitors" data-flag-title="lru cache">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">visitors </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="description"><center> description </center></h2><p><a href=""></a></p>
<h2 id="code"><center> code </center></h2><h3 id="LinkedList_+_HashMap_enhanced_Ver-">LinkedList + HashMap enhanced Ver.</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> val;</span><br><span class="line">        <span class="keyword">int</span> key;</span><br><span class="line">        ListNode next;</span><br><span class="line">        ListNode prev;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ListNode</span> <span class="params">(<span class="keyword">int</span> val, <span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.val = val;</span><br><span class="line">            <span class="keyword">this</span>.key = key;</span><br><span class="line">            <span class="keyword">this</span>.next = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">this</span>.prev = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> capacity = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> ListNode head = <span class="keyword">new</span> ListNode(-<span class="number">1</span>, -<span class="number">1</span>); <span class="comment">// dummy node</span></span><br><span class="line">    <span class="keyword">private</span> ListNode tail = <span class="keyword">new</span> ListNode(-<span class="number">1</span>, -<span class="number">1</span>); <span class="comment">// dummy node</span></span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;Integer, ListNode&gt; cache = <span class="keyword">new</span> HashMap&lt;Integer, ListNode&gt;();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// @param capacity, an integer</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Solution</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// write your code here</span></span><br><span class="line">        <span class="keyword">this</span>.capacity = capacity;</span><br><span class="line">        tail.prev = head; <span class="comment">// #</span></span><br><span class="line">        head.next = tail; <span class="comment">// #</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @return an integer</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// write your code here</span></span><br><span class="line">        ListNode curr;</span><br><span class="line">        <span class="keyword">if</span> (cache.containsKey(key)) &#123;</span><br><span class="line">            curr = cache.get(key);</span><br><span class="line">            <span class="comment">// update linkedList</span></span><br><span class="line">            remove(curr);</span><br><span class="line">            moveToHead(curr);</span><br><span class="line">            <span class="keyword">return</span> curr.val;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// item not exisit in cache</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @param key, an integer</span></span><br><span class="line">    <span class="comment">// @param value, an integer</span></span><br><span class="line">    <span class="comment">// @return nothing</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// write your code here</span></span><br><span class="line">        </span><br><span class="line">        ListNode curr;</span><br><span class="line">        <span class="comment">// check existing key</span></span><br><span class="line">        <span class="keyword">if</span> (cache.containsKey(key)) &#123;</span><br><span class="line">            curr = cache.get(key);</span><br><span class="line">            curr.val = value;</span><br><span class="line">            remove(curr);</span><br><span class="line">            moveToHead(curr);</span><br><span class="line">            </span><br><span class="line">            cache.put(key, curr);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// add new element</span></span><br><span class="line">        ListNode tmp = <span class="keyword">new</span> ListNode(value, key);</span><br><span class="line">        moveToHead(tmp);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (size == capacity) &#123; <span class="comment">// invalidate LRU element</span></span><br><span class="line">            <span class="comment">// remove from cache</span></span><br><span class="line">            cache.remove(tail.prev.key);</span><br><span class="line">            <span class="comment">// remove from linked list</span></span><br><span class="line">            tail.prev = tail.prev.prev;</span><br><span class="line">            tail.prev.next = tail;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        cache.put(key, tmp);</span><br><span class="line">        </span><br><span class="line">        size = size &lt; capacity ? ++size : size; <span class="comment">// size &lt;= capacity</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moveToHead</span><span class="params">(ListNode node)</span> </span>&#123;</span><br><span class="line">        node.next = head.next;</span><br><span class="line">        head.next = node;</span><br><span class="line">        head.next.next.prev = node;</span><br><span class="line">        head.next.prev = head;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(ListNode node)</span> </span>&#123;</span><br><span class="line">        node.prev.next = node.next;</span><br><span class="line">        node.next.prev = node.prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="LinkedList(w/_dummy)_Ver-">LinkedList(w/ dummy) Ver.</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> key;</span><br><span class="line">        <span class="keyword">int</span> val;</span><br><span class="line">        ListNode next;</span><br><span class="line">        ListNode prev;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ListNode</span> <span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.key = key;</span><br><span class="line">            <span class="keyword">this</span>.val = val;</span><br><span class="line">            <span class="keyword">this</span>.next = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">this</span>.prev = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> capacity = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> ListNode head = <span class="keyword">new</span> ListNode(-<span class="number">1</span>,-<span class="number">1</span>); <span class="comment">// dummy node</span></span><br><span class="line">    <span class="keyword">private</span> ListNode tail = <span class="keyword">new</span> ListNode(-<span class="number">1</span>,-<span class="number">1</span>); <span class="comment">// dummy node</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// @param capacity, an integer</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Solution</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// write your code here</span></span><br><span class="line">        <span class="keyword">this</span>.capacity = capacity;</span><br><span class="line">        tail.prev = head; <span class="comment">// #</span></span><br><span class="line">        head.next = tail; <span class="comment">// #</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @return an integer</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// write your code here</span></span><br><span class="line">        ListNode curr = head;</span><br><span class="line">        curr = curr.next;</span><br><span class="line">        <span class="keyword">while</span> (curr.key != -<span class="number">1</span>) &#123; <span class="comment">// reach tail</span></span><br><span class="line">            <span class="keyword">if</span> (key == curr.key) &#123; <span class="comment">// found</span></span><br><span class="line">                remove(curr);</span><br><span class="line">                moveToHead(curr);</span><br><span class="line">                <span class="keyword">return</span> curr.val;</span><br><span class="line">            &#125;</span><br><span class="line">            curr = curr.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// item not exisit in cache</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @param key, an integer</span></span><br><span class="line">    <span class="comment">// @param value, an integer</span></span><br><span class="line">    <span class="comment">// @return nothing</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// write your code here</span></span><br><span class="line">        </span><br><span class="line">        ListNode curr = head;</span><br><span class="line">        curr = curr.next;</span><br><span class="line">        <span class="comment">// check existing key</span></span><br><span class="line">        <span class="keyword">while</span> (curr.key != -<span class="number">1</span>) &#123; <span class="comment">// reach tail</span></span><br><span class="line">            <span class="keyword">if</span> (key == curr.key) &#123;</span><br><span class="line">                curr.val = value;</span><br><span class="line">                remove(curr);</span><br><span class="line">                moveToHead(curr);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            curr = curr.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// add new element</span></span><br><span class="line">        ListNode tmp = <span class="keyword">new</span> ListNode(key, value);</span><br><span class="line">        moveToHead(tmp);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (size == capacity) &#123;</span><br><span class="line">            tail.prev = tail.prev.prev;</span><br><span class="line">            tail.prev.next = tail;</span><br><span class="line">        &#125;</span><br><span class="line">        size = size &lt; capacity ? ++size : size; <span class="comment">// size &lt;= capacity</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moveToHead</span><span class="params">(ListNode node)</span> </span>&#123;</span><br><span class="line">        node.next = head.next;</span><br><span class="line">        head.next = node;</span><br><span class="line">        head.next.next.prev = node;</span><br><span class="line">        head.next.prev = head;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(ListNode node)</span> </span>&#123;</span><br><span class="line">        node.prev.next = node.next;</span><br><span class="line">        node.next.prev = node.prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="LinkedList(wo/dummy)_Ver-">LinkedList(wo/dummy) Ver.</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> key;</span><br><span class="line">        <span class="keyword">int</span> val;</span><br><span class="line">        ListNode next;</span><br><span class="line">        ListNode prev;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ListNode</span> <span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.key = key;</span><br><span class="line">            <span class="keyword">this</span>.val = val;</span><br><span class="line">            <span class="keyword">this</span>.next = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">this</span>.prev = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> capacity = <span class="number">0</span>;</span><br><span class="line">    ListNode head;</span><br><span class="line">    ListNode tail;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// @param capacity, an integer</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Solution</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// write your code here</span></span><br><span class="line">        <span class="keyword">this</span>.capacity = capacity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @return an integer</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// write your code here</span></span><br><span class="line">        ListNode curr = head;</span><br><span class="line">        <span class="comment">//System.out.println("get(" + key + ")");</span></span><br><span class="line">        <span class="comment">//System.out.println("head: " + head.key + ")");</span></span><br><span class="line">        <span class="keyword">while</span> (curr != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">//System.out.println("key: " + curr.key);</span></span><br><span class="line">            <span class="keyword">if</span> (key == curr.key) &#123;</span><br><span class="line">                <span class="comment">// curr == head</span></span><br><span class="line">                <span class="keyword">if</span> (curr.key == head.key) &#123;</span><br><span class="line">                    <span class="keyword">return</span> head.val;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// move to head</span></span><br><span class="line">                <span class="keyword">if</span> (curr.prev != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    curr.prev.next = curr.next;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (curr.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    curr.next.prev = curr.prev;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// if curr is tail, update tail</span></span><br><span class="line">                <span class="keyword">if</span> (curr.key == tail.key) &#123;</span><br><span class="line">                    tail = curr.prev;</span><br><span class="line">                &#125;</span><br><span class="line">                curr.next = head;</span><br><span class="line">                head.prev = curr;</span><br><span class="line">                head = curr;</span><br><span class="line">                <span class="comment">//curr.prev = null;</span></span><br><span class="line">                curr = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">return</span> head.val;</span><br><span class="line">            &#125;</span><br><span class="line">            curr = curr.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @param key, an integer</span></span><br><span class="line">    <span class="comment">// @param value, an integer</span></span><br><span class="line">    <span class="comment">// @return nothing</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// write your code here</span></span><br><span class="line">        <span class="keyword">if</span> (size &lt; capacity) &#123;</span><br><span class="line">            <span class="comment">// space avalibable</span></span><br><span class="line">            <span class="keyword">if</span> (head == <span class="keyword">null</span>) &#123;</span><br><span class="line">                head = <span class="keyword">new</span> ListNode(key, value);</span><br><span class="line">                tail = head;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ListNode tmp = <span class="keyword">new</span> ListNode(key, value);</span><br><span class="line">                tmp.next = head;</span><br><span class="line">                head.prev = tmp;</span><br><span class="line">                head = tmp;</span><br><span class="line">            &#125;</span><br><span class="line">            size++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// LRU invalidate</span></span><br><span class="line">            tail = tail.prev;</span><br><span class="line">            tail.next = <span class="keyword">null</span>;</span><br><span class="line">            ListNode tmp = <span class="keyword">new</span> ListNode(key, value);</span><br><span class="line">            tmp.next = head;</span><br><span class="line">            head.prev = tmp;</span><br><span class="line">            head = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="algorithm"><center> algorithm </center></h2><h3 id="HashMap">HashMap</h3><ul>
<li><strong>add</strong><br>$O(1)$ for fast adding element in hashmap</li>
<li><p><strong>check</strong><br>$O(1)$ for checking element already exist in hashmap <code>containsKey()</code></p>
</li>
<li><p><strong>locate</strong> <strong>LRU</strong> <strong>element</strong><br>We can use additional variable <code>count</code> to record access count and return global min as the LRU element to invalidate. This require $O(capacity)$ time complexity.  </p>
</li>
</ul>
<h3 id="Array">Array</h3><ul>
<li><strong>add</strong><br>$O(1)$ fast adding, using <code>key</code> as array index. might need to store <code>count</code> to find LRU element to invalidate.  </li>
<li><strong>check</strong><br>$O(1)$ for checking element already exist in array  </li>
<li><strong>locate</strong> <strong>LRU</strong> <strong>element</strong><br>We can use additional variable <code>count</code> to record access count and return global min as the LRU element to invalidate. This require $O(capacity)$ time complexity.  </li>
</ul>
<h3 id="LinkedList">LinkedList</h3><p>The benefit of using <code>LinkedList</code> is there is <strong>NO need</strong> to traverse entire array to find out least recent used (LRU) element. Since finding the LRU element happen very frequently after we reach the cache capacity, we want an algorithm has low cost for finding the (LRU) element to invalidate.  </p>
<ul>
<li><strong>add</strong><br>$O(1)$, <code>ListNode</code> instance stores <code>int key</code>, <code>int val</code>, w/ <code>ListNode prev</code> and <code>ListNode next</code>  </li>
<li><strong>check</strong><br>$O(capacity)$ to traverse entire linkedList.  </li>
<li><strong>locate</strong> <strong>LRU</strong> <strong>element</strong><br>$O(1)$ using <code>head</code>, and <code>tail</code> ListNode pointers to track LRU element. No need to traverse and compare <code>count</code> for LRU element.   </li>
</ul>
<p>Always <strong>add</strong> new/update to the <strong>front</strong> of the LinkedList, and <strong>tail</strong> always point to the <strong>LRU</strong> element.  </p>
<p><strong>Dummy Node:</strong><br>very helpful to eliminate processing of special case/boundary condition.  </p>
<h2 id="complexity_analysis"><center> complexity analysis </center></h2><h3 id="LinkedList_+_HashMap_enhanced_Ver--1">LinkedList + HashMap enhanced Ver.</h3><ul>
<li><strong>Time</strong>: $O(1)$  </li>
</ul>
<p>Combine $O(1)$ for add/check operations from hashmap and $O(1)$ for locating LRU element from linkedlist.</p>
<ul>
<li><strong>Space</strong>: $O(capacity)$  </li>
</ul>
<p>cache size.</p>
<h3 id="LinkedList(w/_dummy)_Ver--1">LinkedList(w/ dummy) Ver.</h3><ul>
<li><strong>Time</strong>: $O(capacity)$  </li>
</ul>
<p>Traverse entire linkedList for checking existing element to update in <code>set()</code> method, and same time complexity for <code>get()</code> method.  </p>
<ul>
<li><strong>Space</strong>: $O(capacity)$  </li>
</ul>
<p>cache size.</p>
<h2 id="self_notes"><center> self notes </center></h2><h2 id="application"><center> application </center></h2><h2 id="reference"><center> reference </center></h2><p><a href="http://www.jiuzhang.com/solutions/lru-cache/" target="_blank" rel="external">九章sol</a></p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Cache/" rel="tag">#Cache</a>
          
            <a href="/tags/DataStructure/" rel="tag">#DataStructure</a>
          
            <a href="/tags/HashMap/" rel="tag">#HashMap</a>
          
            <a href="/tags/LRU/" rel="tag">#LRU</a>
          
            <a href="/tags/LinkedList/" rel="tag">#LinkedList</a>
          
            <a href="/tags/LintCode/" rel="tag">#LintCode</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/08/merge-k-sorted-arrays/" rel="next" title="LC486 - merge k sorted arrays">
                <i class="fa fa-chevron-left"></i> LC486 - merge k sorted arrays
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/01/09/LC544-top-k-largest-numbers/" rel="prev" title="LC544 top k largest numbers">
                LC544 top k largest numbers <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/author.jpg"
               alt="🍣之神" />
          <p class="site-author-name" itemprop="name">🍣之神</p>
          <p class="site-description motion-element" itemprop="description">阮先生’s blog</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">69</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">categories</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">53</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/ruanxuyi" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.instagram.com/xuyiruan/" target="_blank" title="Instagram">
                  
                    <i class="fa fa-fw fa-instagram"></i>
                  
                  Instagram
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.linkedin.com/in/xuyi-ruan-a728a889" target="_blank" title="Linkedin">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  Linkedin
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://mszhuchinese.com" title="MsZhuChinese" target="_blank">MsZhuChinese</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.winniebabe.com" title="WinnieBabe" target="_blank">WinnieBabe</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://suncuss.me" title="BossSun" target="_blank">BossSun</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#description"><span class="nav-number">1.</span> <span class="nav-text"> description </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#code"><span class="nav-number">2.</span> <span class="nav-text"> code </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LinkedList_+_HashMap_enhanced_Ver-"><span class="nav-number">2.1.</span> <span class="nav-text">LinkedList + HashMap enhanced Ver.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LinkedList(w/_dummy)_Ver-"><span class="nav-number">2.2.</span> <span class="nav-text">LinkedList(w/ dummy) Ver.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LinkedList(wo/dummy)_Ver-"><span class="nav-number">2.3.</span> <span class="nav-text">LinkedList(wo/dummy) Ver.</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#algorithm"><span class="nav-number">3.</span> <span class="nav-text"> algorithm </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HashMap"><span class="nav-number">3.1.</span> <span class="nav-text">HashMap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Array"><span class="nav-number">3.2.</span> <span class="nav-text">Array</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LinkedList"><span class="nav-number">3.3.</span> <span class="nav-text">LinkedList</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#complexity_analysis"><span class="nav-number">4.</span> <span class="nav-text"> complexity analysis </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LinkedList_+_HashMap_enhanced_Ver--1"><span class="nav-number">4.1.</span> <span class="nav-text">LinkedList + HashMap enhanced Ver.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LinkedList(w/_dummy)_Ver--1"><span class="nav-number">4.2.</span> <span class="nav-text">LinkedList(w/ dummy) Ver.</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#self_notes"><span class="nav-number">5.</span> <span class="nav-text"> self notes </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#application"><span class="nav-number">6.</span> <span class="nav-text"> application </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reference"><span class="nav-number">7.</span> <span class="nav-text"> reference </span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">🍣之神</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'xruan';
      var disqus_identifier = '2017/01/09/lru-cache/';
      var disqus_title = "lru cache";
      var disqus_url = 'http://www.xuyiruan.com/2017/01/09/lru-cache/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  




  
  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("oKoPG1XTXkC7T1oasGQwau2g-gzGzoHsz", "JFJCQtIsUKhrX6S7Gvgqdqgk");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
